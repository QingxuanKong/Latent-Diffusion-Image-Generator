03/13/2025 23:37:43 - INFO - __main__ - ***** Training arguments *****
03/13/2025 23:37:43 - INFO - __main__ - Namespace(config='configs/ddpm.yaml', dataset='cifar10', data_dir='./data', image_size=128, batch_size=4, num_workers=4, num_classes=10, DEBUG=False, wandb_key='b6dff554fc854aea97af8dccb735c241a19a6615', project_name='dl-hw5', run_name='exp-33-test', output_dir='experiments', num_epochs=2, learning_rate=0.0001, weight_decay=0.0001, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=60, num_inference_steps=30, beta_start=0.0002, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, unet_in_size=128, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=2, unet_dropout=0.0, latent_ddpm=False, use_cfg=False, cfg_guidance_scale=2.0, use_ddim=False, ckpt=None, predictor_type='epsilon', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=4, max_train_steps=1250)
03/13/2025 23:37:43 - INFO - __main__ - ***** Running training *****
03/13/2025 23:37:43 - INFO - __main__ -   Num examples = 2500
03/13/2025 23:37:43 - INFO - __main__ -   Num Epochs = 2
03/13/2025 23:37:43 - INFO - __main__ -   Instantaneous batch size per device = 4
03/13/2025 23:37:43 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 4
03/13/2025 23:37:43 - INFO - __main__ -   Total optimization steps per epoch 625
03/13/2025 23:37:43 - INFO - __main__ -   Total optimization steps = 1250
  0%|                                                                      | 0/1250 [00:00<?, ?it/s]03/13/2025 23:37:43 - INFO - __main__ - Epoch 1/2
  0%|                                                              | 1/1250 [00:01<25:19,  1.22s/it]03/13/2025 23:37:44 - INFO - __main__ - Epoch 1/2, Step 0/625, Loss 0.9998962879180908 (0.9998962879180908)
  8%|████▊                                                       | 101/1250 [00:18<03:16,  5.86it/s]03/13/2025 23:38:01 - INFO - __main__ - Epoch 1/2, Step 100/625, Loss 0.361040323972702 (0.712753706639356)
 16%|█████████▋                                                  | 201/1250 [00:35<03:01,  5.78it/s]03/13/2025 23:38:18 - INFO - __main__ - Epoch 1/2, Step 200/625, Loss 0.0491182804107666 (0.43913415035427505)
 24%|██████████████▍                                             | 301/1250 [00:52<02:44,  5.78it/s]03/13/2025 23:38:36 - INFO - __main__ - Epoch 1/2, Step 300/625, Loss 0.03189162164926529 (0.30511706753748397)
 32%|███████████████████▏                                        | 401/1250 [01:10<02:28,  5.73it/s]03/13/2025 23:38:53 - INFO - __main__ - Epoch 1/2, Step 400/625, Loss 0.02136549912393093 (0.23652558102088975)
 40%|████████████████████████                                    | 501/1250 [01:27<02:07,  5.87it/s]03/13/2025 23:39:10 - INFO - __main__ - Epoch 1/2, Step 500/625, Loss 0.02432331256568432 (0.1941297276897315)
 48%|████████████████████████████▊                               | 601/1250 [01:44<01:51,  5.82it/s]03/13/2025 23:39:28 - INFO - __main__ - Epoch 1/2, Step 600/625, Loss 0.03556106984615326 (0.16557925670545628)
100%|███████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 17.02it/s]
03/13/2025 23:39:35 - INFO - __main__ - Epoch 2/2███████████████████| 30/30 [00:01<00:00, 17.01it/s]
Checkpoint saved at experiments/exp-33-test/checkpoints/checkpoint_epoch_0.pth
 50%|██████████████████████████████                              | 626/1250 [01:52<11:17,  1.09s/it]03/13/2025 23:39:35 - INFO - __main__ - Epoch 2/2, Step 0/625, Loss 0.012631537392735481 (0.012631537392735481)
 58%|██████████████████████████████████▊                         | 726/1250 [02:09<01:31,  5.75it/s]03/13/2025 23:39:52 - INFO - __main__ - Epoch 2/2, Step 100/625, Loss 0.015464141964912415 (0.02124716734310778)
 66%|███████████████████████████████████████▋                    | 826/1250 [02:26<01:13,  5.77it/s]03/13/2025 23:40:10 - INFO - __main__ - Epoch 2/2, Step 200/625, Loss 0.013161683455109596 (0.021136734792174986)
 74%|████████████████████████████████████████████▍               | 926/1250 [02:44<00:56,  5.77it/s]03/13/2025 23:40:27 - INFO - __main__ - Epoch 2/2, Step 300/625, Loss 0.022543296217918396 (0.020465807274503763)
 82%|████████████████████████████████████████████████▍          | 1026/1250 [03:01<00:38,  5.84it/s]03/13/2025 23:40:44 - INFO - __main__ - Epoch 2/2, Step 400/625, Loss 0.012217480689287186 (0.019785120012586997)
 90%|█████████████████████████████████████████████████████▏     | 1126/1250 [03:18<00:21,  5.80it/s]03/13/2025 23:41:02 - INFO - __main__ - Epoch 2/2, Step 500/625, Loss 0.024239178746938705 (0.01980694452906678)
 98%|█████████████████████████████████████████████████████████▊ | 1226/1250 [03:36<00:04,  5.76it/s]03/13/2025 23:41:19 - INFO - __main__ - Epoch 2/2, Step 600/625, Loss 0.012995368801057339 (0.019415253443262243)
100%|███████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 17.03it/s]
100%|███████████████████████████████████████████████████████████| 1250/1250 [03:42<00:00,  5.61it/s]
Checkpoint saved at experiments/exp-33-test/checkpoints/checkpoint_epoch_1.pth
