03/13/2025 23:55:02 - INFO - __main__ - ***** Training arguments *****
03/13/2025 23:55:02 - INFO - __main__ - Namespace(config='configs/ddim.yaml', dataset='cifar10', data_dir='./data', image_size=128, batch_size=4, num_workers=4, num_classes=10, DEBUG=False, wandb_key='b6dff554fc854aea97af8dccb735c241a19a6615', project_name='dl-hw5', run_name='exp-37-test', output_dir='experiments', num_epochs=2, learning_rate=0.0001, weight_decay=0.0001, grad_clip=1.0, seed=42, mixed_precision='none', num_train_timesteps=60, num_inference_steps=30, beta_start=0.0002, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, unet_in_size=128, unet_in_ch=3, unet_ch=128, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=2, unet_dropout=0.0, latent_ddpm=False, use_cfg=False, cfg_guidance_scale=2.0, use_ddim=True, ckpt=None, predictor_type='epsilon', distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=4, max_train_steps=1250)
03/13/2025 23:55:02 - INFO - __main__ - ***** Running training *****
03/13/2025 23:55:02 - INFO - __main__ -   Num examples = 2500
03/13/2025 23:55:02 - INFO - __main__ -   Num Epochs = 2
03/13/2025 23:55:02 - INFO - __main__ -   Instantaneous batch size per device = 4
03/13/2025 23:55:02 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 4
03/13/2025 23:55:02 - INFO - __main__ -   Total optimization steps per epoch 625
03/13/2025 23:55:02 - INFO - __main__ -   Total optimization steps = 1250
  0%|                                                                      | 0/1250 [00:00<?, ?it/s]03/13/2025 23:55:02 - INFO - __main__ - Epoch 1/2
  0%|                                                              | 1/1250 [00:01<25:08,  1.21s/it]03/13/2025 23:55:04 - INFO - __main__ - Epoch 1/2, Step 0/625, Loss 0.9998962879180908 (0.9998962879180908)
  8%|████▊                                                       | 101/1250 [00:18<03:18,  5.78it/s]03/13/2025 23:55:21 - INFO - __main__ - Epoch 1/2, Step 100/625, Loss 0.3600068986415863 (0.7134209363767416)
 16%|█████████▋                                                  | 201/1250 [00:35<03:00,  5.81it/s]03/13/2025 23:55:38 - INFO - __main__ - Epoch 1/2, Step 200/625, Loss 0.04964188486337662 (0.4406858419267396)
 24%|██████████████▍                                             | 301/1250 [00:52<02:44,  5.78it/s]03/13/2025 23:55:55 - INFO - __main__ - Epoch 1/2, Step 300/625, Loss 0.03098887763917446 (0.3061841768135264)
 32%|███████████████████▏                                        | 401/1250 [01:10<02:29,  5.68it/s]03/13/2025 23:56:13 - INFO - __main__ - Epoch 1/2, Step 400/625, Loss 0.021017221733927727 (0.23723533019386325)
 40%|████████████████████████                                    | 501/1250 [01:27<02:10,  5.73it/s]03/13/2025 23:56:30 - INFO - __main__ - Epoch 1/2, Step 500/625, Loss 0.02417299710214138 (0.1946273796918417)
 48%|████████████████████████████▊                               | 601/1250 [01:45<01:52,  5.75it/s]03/13/2025 23:56:48 - INFO - __main__ - Epoch 1/2, Step 600/625, Loss 0.0344996303319931 (0.16596581749525077)
100%|███████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 16.93it/s]
03/13/2025 23:56:55 - INFO - __main__ - Epoch 2/2███████████████████| 30/30 [00:01<00:00, 17.05it/s]
Checkpoint saved at experiments/exp-37-test/checkpoints/checkpoint_epoch_0.pth
 50%|██████████████████████████████                              | 626/1250 [01:52<11:43,  1.13s/it]03/13/2025 23:56:55 - INFO - __main__ - Epoch 2/2, Step 0/625, Loss 0.012430185452103615 (0.012430185452103615)
 58%|██████████████████████████████████▊                         | 726/1250 [02:10<01:31,  5.71it/s]03/13/2025 23:57:13 - INFO - __main__ - Epoch 2/2, Step 100/625, Loss 0.015586407855153084 (0.021511144087751313)
 66%|███████████████████████████████████████▋                    | 826/1250 [02:27<01:13,  5.79it/s]03/13/2025 23:57:30 - INFO - __main__ - Epoch 2/2, Step 200/625, Loss 0.013045555911958218 (0.021230100561396695)
 74%|████████████████████████████████████████████▍               | 926/1250 [02:45<00:55,  5.80it/s]03/13/2025 23:57:47 - INFO - __main__ - Epoch 2/2, Step 300/625, Loss 0.022423533722758293 (0.020501738510085302)
 82%|████████████████████████████████████████████████▍          | 1026/1250 [03:02<00:39,  5.69it/s]03/13/2025 23:58:05 - INFO - __main__ - Epoch 2/2, Step 400/625, Loss 0.01213743444532156 (0.019802789963280172)
 90%|█████████████████████████████████████████████████████▏     | 1126/1250 [03:19<00:21,  5.85it/s]03/13/2025 23:58:22 - INFO - __main__ - Epoch 2/2, Step 500/625, Loss 0.024206092581152916 (0.019812685733069917)
 98%|█████████████████████████████████████████████████████████▊ | 1226/1250 [03:37<00:04,  5.65it/s]03/13/2025 23:58:40 - INFO - __main__ - Epoch 2/2, Step 600/625, Loss 0.012961996719241142 (0.019412016458871362)
100%|███████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 17.04it/s]
100%|███████████████████████████████████████████████████████████| 1250/1250 [03:44<00:00,  5.57it/s]
Checkpoint saved at experiments/exp-37-test/checkpoints/checkpoint_epoch_1.pth
